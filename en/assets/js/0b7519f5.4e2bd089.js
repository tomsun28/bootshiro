"use strict";(self.webpackChunktancloud=self.webpackChunktancloud||[]).push([[4349],{4137:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=s(n),m=r,h=u["".concat(c,".").concat(m)]||u[m]||p[m]||i;return n?a.createElement(h,o(o({ref:t},d),{},{components:n})):a.createElement(h,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4359:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return c},metadata:function(){return s},toc:function(){return d},default:function(){return u}});var a=n(7462),r=n(3366),i=(n(7294),n(4137)),o=["components"],l={id:"tdengine-init",title:"Dependency Service TDengine Installation and Initialization",sidebar_label:"TDengine Init(optional)"},c=void 0,s={unversionedId:"start/tdengine-init",id:"start/tdengine-init",title:"Dependency Service TDengine Installation and Initialization",description:"TDengine is a time series database. We use TDengine to replace the InfluxDb, to store the history data collected monitoring Metrics.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/start/tdengine-init.md",sourceDirName:"start",slug:"/start/tdengine-init",permalink:"/en/docs/start/tdengine-init",editUrl:"https://github.com/dromara/hertzbeat/edit/master/home/i18n/en/docusaurus-plugin-content-docs/current/start/tdengine-init.md",tags:[],version:"current",frontMatter:{id:"tdengine-init",title:"Dependency Service TDengine Installation and Initialization",sidebar_label:"TDengine Init(optional)"},sidebar:"docs",previous:{title:"Quick Start",permalink:"/en/docs/start/quickstart"},next:{title:"Install via Docker",permalink:"/en/docs/start/docker-deploy"}},d=[{value:"Install TDengine via Docker",id:"install-tdengine-via-docker",children:[],level:3},{value:"Create database instance",id:"create-database-instance",children:[],level:3},{value:"Configure the database connection in hertzbeat <code>application.yml</code>configuration file",id:"configure-the-database-connection-in-hertzbeat-applicationymlconfiguration-file",children:[],level:3},{value:"Common issues",id:"common-issues",children:[],level:3}],p={toc:d};function u(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"TDengine is a time series database. We use TDengine to replace the InfluxDb, to store the history data collected monitoring Metrics.\nNote\u26a0\ufe0f TDengine is optional. And no configuration means no historical chart data.\nNote\u26a0\ufe0f Need TDengine 2.4.x Version.   "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"If you have TDengine environment, can directly skip to create a database instance.")),(0,i.kt)("h3",{id:"install-tdengine-via-docker"},"Install TDengine via Docker"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Refer to the official website ",(0,i.kt)("a",{parentName:"p",href:"https://www.taosdata.com/docs/cn/v2.0/getting-started/docker"},"installation tutorial"),"  "),(0,i.kt)("ol",{parentName:"blockquote"},(0,i.kt)("li",{parentName:"ol"},"Download and install Docker environment",(0,i.kt)("br",{parentName:"li"}),"Docker tools download refer to ",(0,i.kt)("a",{parentName:"li",href:"https://docs.docker.com/get-docker/"},"Docker official document"),".\nAfter the installation you can check if the Docker version normally output at the terminal.",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"$ docker -v\nDocker version 20.10.12, build e91ed57\n"))),(0,i.kt)("li",{parentName:"ol"},"Install TDengine with Docker",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"$ docker run -d -p 6030-6049:6030-6049 -p 6030-6049:6030-6049/udp -v /opt/taosdata:/var/lib/taos --name tdengine -e TZ=Asia/Shanghai tdengine/tdengine:2.4.0.12\n")),(0,i.kt)("inlineCode",{parentName:"li"},"-v /opt/taosdata:/var/lib/taos")," is local persistent mount of TDengine data directory.",(0,i.kt)("inlineCode",{parentName:"li"},"/opt/taosdata")," should be replaced with the actual local directory.\n",(0,i.kt)("inlineCode",{parentName:"li"},'-e TZ="Asia/Shanghai"')," can set time zone for TDengine.Set up the corresponding time zone you want.\nuse",(0,i.kt)("inlineCode",{parentName:"li"},"$ docker ps")," to check if the database started successfully"))),(0,i.kt)("h3",{id:"create-database-instance"},"Create database instance"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Enter database Docker container  ",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"$ docker exec -it tdengine /bin/bash\n"))),(0,i.kt)("li",{parentName:"ol"},"Create database named hertzbeat\nAfter entering the container\uff0cexecute ",(0,i.kt)("inlineCode",{parentName:"li"},"taos")," command as follows: ",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"root@tdengine-server:~/TDengine-server-2.4.0.4# taos\nWelcome to the TDengine shell from Linux, Client Version:2.4.0.4\nCopyright (c) 2020 by TAOS Data, Inc. All rights reserved.\ntaos>\n")),"execute commands to create database",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"taos> show databases;\ntaos> CREATE DATABASE hertzbeat KEEP 90 DAYS 10 BLOCKS 6 UPDATE 1;\n")),"The above statements will create a database named hertzbeat. The data will be saved for 90 days (more than 90 days data will be automatically deleted).\nA data file every 10 days, memory blocks is 6, allow you to update the data."),(0,i.kt)("li",{parentName:"ol"},"Check if hertzbeat database has been successfully created",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"taos> show databases;\ntaos> use hertzbeat;\n")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Note\u26a0\ufe0fIf you install TDengine2.3+ version"),"       "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"In addition to start the server\uff0cyou must execute ",(0,i.kt)("inlineCode",{parentName:"p"},"systemctl start taosadapter")," to start adapter")),(0,i.kt)("h3",{id:"configure-the-database-connection-in-hertzbeat-applicationymlconfiguration-file"},"Configure the database connection in hertzbeat ",(0,i.kt)("inlineCode",{parentName:"h3"},"application.yml"),"configuration file"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Configure HertzBeat's configuration file\nModify ",(0,i.kt)("inlineCode",{parentName:"li"},"hertzbeat/config/application.yml")," configuration file",(0,i.kt)("br",{parentName:"li"}),"Note\u26a0\ufe0fThe docker container way need to mount application.yml file locally,while you can use installation package way to unzip and modify ",(0,i.kt)("inlineCode",{parentName:"li"},"hertzbeat/config/application.yml"),(0,i.kt)("br",{parentName:"li"}),"Replace ",(0,i.kt)("inlineCode",{parentName:"li"},"warehouse.store.td-engine")," data source parameters, URL account and password.     ")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"   warehouse.store.td-engine.enable\n   warehouse.store.td-engine.url\n   warehouse.store.td-engine.username\n   warehouse.store.td-engine.password\n\n")),(0,i.kt)("h3",{id:"common-issues"},"Common issues"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If the history chart on the monitoring page is not displayed\uff0cpopup ","[unable to provide historical chart data, please configure dependency service on TDengine time series database]"),(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"As shown in the popup window\uff0cthe premise of history chart display is that you need install and configure HertzBeat's dependency service - TDengine database."))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"The historical picture of monitoring details is not displayed or has no data, and TDengine has been deployed     "),(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"Please confirm whether the installed TDengine version is near 2.4.0.12, version 3.0 and 2.2 are not compatible.")))))}u.isMDXComponent=!0}}]);